---
title: Datasets
description: "Reusable benchmarking datasets and their file format specifications"
order: 40
engine: knitr
---

{{< include ../../_include/_clone_repo_openproblems.qmd >}}
{{< include /_include/_evaluate_code.qmd >}}

To ensure interoperability between components, OpenProblems uses {{< glossary AnnData >}} as the standard data format for both input and output files of components, and strict requirements are imposed on the format of these files.

![AnnData objects have a structured format that includes the main data matrix (`X`, e.g. gene expression values), annotations of observations (`obs`, e.g. cell metadata), annotations of variables (`var`, e.g. gene metadata), and unstructured annotations (`uns`). This organization makes it easy to work with complex datasets while maintaining data integrity and ensuring a standardized structure across different components.](/documentation/images/anndata.svg){#fig-anndata-format width="60%"}


# File format specifications

All OpenProblems tasks contain specifications for exact format of all H5AD inputs and outputs for all components in the workflow. These specifications contain information on the required and optional fields in the AnnData objects, as well as descriptions of those fields. These files are used to validate the input and output files of components, and to generate the documentation for the API of each component.

You should be able to find these specifications in the `src/tasks/*/api/file_*.yaml` of each task. Here's an example of such a specification: [`src/datasets/api/file_raw.yaml`](https://github.com/openproblems-bio/openproblems-v2/blob/main/src/datasets/api/file_raw.yaml).

For more information on how these specifications are formatted, see ["Design the API"](/documentation/create_task/design_api.qmd#step-2).

# Common datasets

OpenProblems offers a collection of common datasets that can be used to test components and run the benchmarking tasks. These datasets are generated by dataset loaders and processed by a common processing pipeline stored in [`src/datasets`](/documentation/reference/openproblems-v2/src-datasets.qmd). 

{{< include /documentation/_figures/_project_structure_dataset_workflow.qmd >}}

## File format of common datasets

The format of common datasets is based on the [CELLxGENE schema](https://github.com/chanzuckerberg/single-cell-curation/blob/main/schema/4.0.0/schema.md) along with additional metadata that is specific to OpenProblems (in the `.uns` slot) and some additional output generated by our dataset preprocessors (in the `.layers`, `.obsm`, `obsp` and `.varm` slots).

Here is what a typical common dataset looks like when printed to the console:

```{r echo=FALSE, warning=FALSE, error=FALSE}
spec <- openproblems.docs::read_file_format("src/datasets/api/file_common_dataset.yaml")

str <- openproblems.docs::render_file_format(spec)

knitr::asis_output(c(
  ":::{{.small}}\n\n",
  paste0(str, "\n"),
  "\n:::\n"
))
```

Some slots might not be available depending on the origin of the dataset.
Please visit the reference documentation on the [common dataset file format](/documentation/reference/openproblems-v2/src-datasets.qmd#file-format-common-dataset) used by OpenProblems for more information on each of the different slots.

:::{.callout-note}
In OpenProblems, the X slot in the AnnData objects is typically not defined (`None` in Python, `NULL` in R). Instead, the raw counts and normalised expression data are defined as layers.
:::

## Available datasets

Our datasets are stored in `s3://openproblems-data/resources/datasets`. Please visit the [datasets](/datasets) page for more information on each of the available datasets.